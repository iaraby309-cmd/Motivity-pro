<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Motivity AI - Ultimate Engineering Suite</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        :root{ --motivity-red:#e60012; --tech-blue:#38bdf8; --bg:#0d1117; }
        *{box-sizing:border-box; font-family:'Cairo', sans-serif; margin:0; padding:0}
        body{background:var(--bg); color:#fff; display:flex; height:100vh; overflow:hidden}
        .sidebar{width:420px; background:#161b22; padding:20px; overflow-y:auto; border-left:3px solid var(--motivity-red); flex-shrink:0}
        .box{background:#21262d; padding:15px; border-radius:10px; margin-bottom:12px; border:1px solid #30363d}
        h3{font-size:14px; color:var(--tech-blue); margin-bottom:8px; border-bottom:1px solid #444}
        label{font-size:11px; color:#8b949e; display:block; margin-top:8px}
        input, select{width:100%; padding:8px; background:#0d1117; color:#fff; border:1px solid #30363d; border-radius:6px; margin-top:4px}
        .main-view{flex:1; display:flex; flex-direction:column; align-items:center; justify-content:center; padding:10px; background:#000}
        canvas{background:#050505; border:1px solid #444; border-radius:10px; width:95%; height:auto; max-height:85vh; cursor: crosshair;}
        button{padding:12px; border:none; border-radius:8px; cursor:pointer; width:100%; font-weight:700; margin-top:10px}
        .btn-smart{background:var(--tech-blue); color:#000; border:2px solid #fff}
        .btn-report{background:var(--motivity-red); color:#fff}
        
        /* Ø¥Ø¶Ø§ÙØ§Øª Ø§Ù„ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© */
        .manual-item { background: #30363d; padding: 5px 10px; border-radius: 5px; margin-top: 5px; font-size: 11px; display: flex; justify-content: space-between; align-items: center; border-right: 3px solid var(--tech-blue); }
        .btn-del { color: var(--motivity-red); cursor: pointer; font-weight: bold; }

        #reportPage{display:none; position:fixed; inset:0; background:#fff; z-index:9999; color:#333; overflow-y:auto; padding:40px}
        .report-content{max-width:950px; margin:auto; border:2px solid #ddd; padding:30px; box-shadow: 0 0 20px rgba(0,0,0,0.1)}
        table{width:100%; border-collapse:collapse; margin:20px 0}
        th, td{border:1px solid #ddd; padding:10px; text-align:right}
        th {background:#f8f9fa}
        .status-box{padding:15px; border-radius:8px; margin-bottom:20px; font-weight:bold; text-align:center; line-height:1.6}
        .ok{background:#dcfce7; color:#166534; border:1px solid #b9f6ca}
        .low{background:#fee2e2; color:#991b1b; border:1px solid #ffcdd2}
        .report-header { text-align: center; border-bottom: 4px solid var(--motivity-red); padding-bottom: 15px; margin-bottom: 25px; }
    </style>
</head>
<body>

<div class="sidebar no-print">
    <h2 style="color:var(--motivity-red); text-align:center; margin-bottom:15px">MOTIVITY AI DESIGNER</h2>
    
    <div class="box">
        <h3>ğŸ“ Ø£Ø¨Ø¹Ø§Ø¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹ ÙˆØ§Ù„Ø§Ø±ØªÙØ§Ø¹</h3>
        <div style="display:flex; gap:5px">
            <div><label>Ø§Ù„Ø·ÙˆÙ„</label><input type="number" id="room_l" value="40" oninput="draw()"></div>
            <div><label>Ø§Ù„Ø¹Ø±Ø¶</label><input type="number" id="room_w" value="25" oninput="draw()"></div>
            <div><label>Ø§Ù„Ø§Ø±ØªÙØ§Ø¹ H</label><input type="number" id="room_h" value="8" oninput="draw()"></div>
        </div>
        <div style="display:flex; gap:5px">
            <div><label>Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø³Ø±Ø­</label><input type="number" id="stage_w" value="15" oninput="draw()"></div>
            <div><label>Ø¹Ù…Ù‚ Ø§Ù„Ù…Ø³Ø±Ø­</label><input type="number" id="stage_d" value="6" oninput="draw()"></div>
        </div>
    </div>

    <button class="btn-smart" onclick="applySmart()">âœ¨ ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­ Ø§Ù„Ø°ÙƒÙŠ Ø§Ù„Ø´Ø§Ù…Ù„</button>

    <div class="box">
        <h3>ğŸ”Š Ø§Ù„Ø£Ù†Ø¸Ù…Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© (Motivity All Series)</h3>
        <label>Ø§Ù„Ù…ÙˆØ¯ÙŠÙ„ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ</label>
        <select id="main_pa" onchange="draw()">
            <optgroup label="Line Array Series">
                <option value="MLA212">MLA212 (Dual 12")</option>
                <option value="MLA210">MLA210 (Dual 10")</option>
                <option value="M10-LA">M10-LA (Compact)</option>
            </optgroup>
            <optgroup label="Point Source & Stadium">
                <option value="DB-25 3G">DB-25 3G High Performance</option>
                <option value="MTL-700 3G">MTL-700 3G Stadium</option>
                <option value="HD-15A">HD-15A Active</option>
            </optgroup>
        </select>
        <label>Ø¹Ø¯Ø¯ Ø§Ù„Ø³Ù…Ø§Ø¹Ø§Øª</label><input type="number" id="main_qty" value="12" oninput="draw()">
        
        <label>Ù†Ø¸Ø§Ù… Ø§Ù„ØµØ¨ÙˆÙØ±</label>
        <select id="sub_pa" onchange="draw()">
            <option value="QX-218">QX-218 Dual 18"</option>
            <option value="QX-118">QX-118 Single 18"</option>
            <option value="M-25BW">M-25BW Sub</option>
            <option value="DB-218">DB-218 3G</option>
        </select>
        <label>Ø¹Ø¯Ø¯ Ø§Ù„ØµØ¨Ø§Øª</label><input type="number" id="sub_qty" value="8" oninput="draw()">
    </div>

    <div class="box">
        <h3>â• Ø¥Ø¶Ø§ÙØ§Øª ÙŠØ¯ÙˆÙŠØ© (Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø±Ø³Ù…)</h3>
        <label>Ø§Ø³Ù… Ø§Ù„Ø¬Ù‡Ø§Ø²</label>
        <input type="text" id="manual_name" placeholder="Ù…Ø«Ù„Ø§Ù‹: Ù…ÙŠÙƒØ±ÙˆÙÙˆÙ†ØŒ Ø¨ÙŠØ§Ù†Ùˆ...">
        <div id="manual_list" style="margin-top:10px"></div>
        <button onclick="manualPoints=[]; draw(); renderList();" style="font-size:10px; background:#444; padding:5px">ØªÙØ±ÙŠØº Ø§Ù„Ù†Ù‚Ø§Ø·</button>
    </div>

    <div class="box">
        <h3>ğŸ“¢ Ø§Ù„Ù…ÙˆÙ†ÙŠØªÙˆØ± ÙˆØ§Ù„Ø¬ÙˆØ§Ù†Ø¨</h3>
        <label>Ø§Ù„Ù…ÙˆÙ†ÙŠØªÙˆØ±</label>
        <select id="mon_pa" onchange="draw()">
            <option value="DB-15M 3G">DB-15M 3G Monitor</option>
            <option value="MTL-152">MTL-152 Monitor</option>
            <option value="HD312A">HD312A Active</option>
        </select>
        <label>Ø¹Ø¯Ø¯ Ø§Ù„Ù…ÙˆÙ†ÙŠØªÙˆØ±</label><input type="number" id="mon_qty" value="4" oninput="draw()">
        
        <label>Ø³Ù…Ø§Ø¹Ø§Øª Ø§Ù„Ø¬ÙˆØ§Ù†Ø¨</label>
        <select id="side_pa" onchange="draw()">
            <option value="HD315A">HD315A Side Fill</option>
            <option value="DB-25 NW">DB-25 NW Neodymium</option>
            <option value="MTL-700 3G">MTL-700 3G Side</option>
        </select>
        <label>Ø¹Ø¯Ø¯ Ø§Ù„Ø¬ÙˆØ§Ù†Ø¨</label><input type="number" id="side_qty" value="4" oninput="draw()">
    </div>

    <button class="btn-report" onclick="openReport()">ğŸ“„ Ø¹Ø±Ø¶ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„ÙÙ†ÙŠ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ</button>
</div>

<div class="main-view no-print">
    <canvas id="mainCanvas"></canvas>
    <div style="margin-top:5px; font-size:12px; color:#8b949e">Ø§Ù†Ù‚Ø± Ù„Ø¥Ø¶Ø§ÙØ© Ù†Ù‚Ø§Ø· Ù…ÙŠØ¯Ø§Ù†ÙŠØ© | Ø§Ù„Ø±Ø³Ù… ÙŠÙˆØ²Ø¹ Ø§Ù„Ø³Ù…Ø§Ø¹Ø§Øª Ø¢Ù„ÙŠØ§Ù‹</div>
</div>

<div id="reportPage">
    <div class="report-content">
        <button class="no-print" onclick="document.getElementById('reportPage').style.display='none'" style="float:left; background:#444; color:#fff; padding:8px 15px; border-radius:5px; border:none; cursor:pointer">â¬…ï¸ Ø±Ø¬ÙˆØ¹</button>
        <div class="report-header">
            <h1 style="color:var(--motivity-red)">ØªÙ‚Ø±ÙŠØ± Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù‡ÙŠÙƒÙ„ÙŠ Ø§Ù„ØµÙˆØªÙŠ - Motivity AI</h1>
            <p style="font-weight:bold">Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø­Ø§ÙƒØ§Ø© Ø§Ù„Ø°ÙƒÙŠ Ù„Ù‚Ø§Ø¹Ø§Øª Ø§Ù„Ø§Ø­ØªÙØ§Ù„Ø§Øª Ø§Ù„Ù…ØºÙ„Ù‚Ø©</p>
        </div>
        
        <div id="statusAnalysis"></div>
        <div id="roomSummary" style="margin-bottom:20px; font-weight:bold; background:#f4f4f4; padding:15px; border-right:5px solid var(--tech-blue)"></div>
        
        <h3>1. Ù…ØµÙÙˆÙØ© Ø§Ù„Ù…Ø¹Ø¯Ø§Øª Ø§Ù„Ù…Ø¹ØªÙ…Ø¯Ø© (BOQ)</h3>
        <table id="boqTable"></table>

        <div id="manualSection" style="display:none">
            <h3>2. Ø§Ù„Ø£Ø¬Ù‡Ø²Ø© ÙˆØ§Ù„Ù…Ù„Ø­Ù‚Ø§Øª Ø§Ù„Ù…ÙŠØ¯Ø§Ù†ÙŠØ© Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ©</h3>
            <table id="manualTable"></table>
        </div>

        <div style="background:#f0f7ff; padding:20px; border-radius:10px; margin-top:20px">
            <h3 style="color:#0056b3">âš¡ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø§Ù„Ù‡Ù†Ø¯Ø³ÙŠØ© ÙˆØ§Ù„ØªØ´ØºÙŠÙ„ÙŠØ©</h3>
            <p>â€¢ <b>Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø±Ù‚Ù…ÙŠØ©:</b> ÙŠÙˆØµÙ‰ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…Ø¹Ø§Ù„Ø¬Ø§Øª Motivity DSP Ù„Ø¶Ø¨Ø· Ø§Ù„ØªÙˆÙ‚ÙŠØª Ø§Ù„Ø²Ù…ÙŠ (Time Alignment) Ø¨ÙŠÙ† Ø§Ù„Ù…ØµÙÙˆÙØ§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© ÙˆØ§Ù„ØµØ¨ÙˆÙØ±.</p>
            <p>â€¢ <b>ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø·Ø§Ù‚Ø©:</b> Ø¶Ø±ÙˆØ±Ø© Ø§Ø³ØªØ®Ø¯Ø§Ù… ÙˆØ­Ø¯Ø§Øª Power Sequence Ù„Ø¶Ù…Ø§Ù† Ø§Ø³ØªÙ‚Ø±Ø§Ø± Ø§Ù„ØªÙŠØ§Ø± Ø¹Ù†Ø¯ Ø§Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„ÙƒÙ„ÙŠ Ù„Ù„Ù‚Ø§Ø¹Ø©.</p>
        </div>

        <div style="text-align:center; margin-top:30px">
            <h4>Ø§Ù„Ù…Ø®Ø·Ø· Ø§Ù„Ù‡Ù†Ø¯Ø³ÙŠ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ Ù„Ù„ØªÙˆØ²ÙŠØ¹ (Top View)</h4>
            <img id="reportImg" style="width:100%; border:2px solid #333; border-radius:10px; background:#000">
        </div>
        
        <button class="btn-report no-print" onclick="window.print()" style="margin-top:20px; width:100%">ØªØµØ¯ÙŠØ± Ø§Ù„ØªÙ‚Ø±ÙŠØ± PDF</button>
    </div>
</div>

<script>
    const canvas = document.getElementById('mainCanvas');
    const ctx = canvas.getContext('2d');
    let manualPoints = [];

    // Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù†Ù‚Ø§Ø· Ø§Ù„ÙŠØ¯ÙˆÙŠØ©
    canvas.addEventListener('mousedown', (e) => {
        const rect = canvas.getBoundingClientRect();
        const x = (e.clientX - rect.left) * (canvas.width / rect.width);
        const y = (e.clientY - rect.top) * (canvas.height / rect.height);
        const name = document.getElementById('manual_name').value || "Ø¥Ø¶Ø§ÙØ© Ù…ÙŠØ¯Ø§Ù†ÙŠØ©";
        manualPoints.push({x, y, name});
        renderList();
        draw();
    });

    function renderList() {
        const container = document.getElementById('manual_list');
        container.innerHTML = '';
        manualPoints.forEach((p, i) => {
            container.innerHTML += `<div class="manual-item">${p.name} <span class="btn-del" onclick="manualPoints.splice(${i},1); renderList(); draw();">Ã—</span></div>`;
        });
    }

    function applySmart() {
        const L = parseFloat(document.getElementById('room_l').value);
        const H = parseFloat(document.getElementById('room_h').value);
        // Ù…Ù†Ø·Ù‚ Ø§Ø­ØªØ±Ø§ÙÙŠ: Ø§Ù„Ù‚Ø§Ø¹Ø© Ø§Ù„ÙƒØ¨ÙŠØ±Ø© ØªØ­ØªØ§Ø¬ Ø¹Ù…Ù‚ ØµÙˆØªÙŠ Ù„Ø§ ÙŠÙ‚Ù„ Ø¹Ù† 16 Ø³Ù…Ø§Ø¹Ø© (Ù…Ø¬Ù…ÙˆØ¹)
        document.getElementById('main_qty').value = Math.max(16, Math.ceil((L * H) / 20));
        document.getElementById('sub_qty').value = Math.ceil(document.getElementById('main_qty').value / 2);
        document.getElementById('mon_qty').value = 4;
        document.getElementById('side_qty').value = Math.ceil(L / 8);
        draw();
    }

    function draw() {
        const L = parseFloat(document.getElementById('room_l').value) || 10;
        const W = parseFloat(document.getElementById('room_w').value) || 10;
        const sW = parseFloat(document.getElementById('stage_w').value) || 0;
        const sD = parseFloat(document.getElementById('stage_d').value) || 0;

        canvas.width = 1100; canvas.height = 650;
        const scale = Math.min(canvas.width/L, canvas.height/W) * 0.9;
        const oX = (canvas.width - L*scale)/2;
        const oY = (canvas.height - W*scale)/2;

        ctx.clearRect(0,0,canvas.width,canvas.height);
        ctx.fillStyle = "#050505"; ctx.fillRect(oX, oY, L*scale, W*scale);
        ctx.strokeStyle = "#444"; ctx.strokeRect(oX, oY, L*scale, W*scale);

        // Ø§Ù„Ù…Ø³Ø±Ø­
        const stX = oX + (L*scale - sW*scale)/2;
        ctx.strokeStyle = "#e60012"; ctx.lineWidth = 3;
        ctx.strokeRect(stX, oY, sW*scale, sD*scale);
        ctx.fillStyle = "rgba(230,0,18,0.1)"; ctx.fillRect(stX, oY, sW*scale, sD*scale);

        // Ø§Ù„ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø¢Ù„ÙŠ Ù„Ù„Ø³Ù…Ø§Ø¹Ø§Øª (Ø§Ù„Ø£ØµÙ„ÙŠ)
        const mq = parseInt(document.getElementById('main_qty').value);
        ctx.fillStyle = "#38bdf8";
        for(let i=0; i<Math.ceil(mq/2); i++) {
            ctx.fillRect(stX - 25, oY + (i*15) + 5, 20, 12);
            ctx.fillRect(stX + sW*scale + 5, oY + (i*15) + 5, 20, 12);
        }

        const sdq = parseInt(document.getElementById('side_qty').value);
        ctx.fillStyle = "#facc15";
        const sideSpacing = (W * scale) / (Math.ceil(sdq/2) + 1);
        for(let i=1; i<=Math.ceil(sdq/2); i++) {
            ctx.fillRect(oX + 5, oY + (i * sideSpacing), 12, 18);
            ctx.fillRect(oX + L*scale - 17, oY + (i * sideSpacing), 12, 18);
        }

        const sq = parseInt(document.getElementById('sub_qty').value);
        ctx.fillStyle = "#e60012";
        for(let i=0; i<sq; i++) ctx.fillRect(stX + (i * (sW*scale/sq)) + 2, oY + sD*scale + 10, 15, 15);
        
        const monq = parseInt(document.getElementById('mon_qty').value);
        ctx.fillStyle = "#4ade80";
        for(let i=0; i<monq; i++) ctx.fillRect(stX + (i * (sW*scale/monq)) + 10, oY + sD*scale - 15, 15, 8);

        // Ø±Ø³Ù… Ø§Ù„Ù†Ù‚Ø§Ø· Ø§Ù„ÙŠØ¯ÙˆÙŠØ©
        manualPoints.forEach(p => {
            ctx.beginPath(); ctx.arc(p.x, p.y, 7, 0, Math.PI*2);
            ctx.fillStyle = "#fff"; ctx.fill(); ctx.strokeStyle = "#e60012"; ctx.stroke();
            ctx.fillStyle = "#fff"; ctx.font = "10px Cairo"; ctx.fillText(p.name, p.x + 10, p.y + 5);
        });
    }

    function openReport() {
        const L = parseFloat(document.getElementById('room_l').value);
        const H = parseFloat(document.getElementById('room_h').value);
        const mq = parseInt(document.getElementById('main_qty').value);
        
        // Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù‡Ù†Ø¯Ø³ÙŠ Ø§Ù„Ø°ÙƒÙŠ
        const isSafe = mq >= (L * H / 22); // Ù…Ø¹ÙŠØ§Ø± ØªØ´Ø¯ÙŠØ¯ Ù„Ù„ÙƒÙØ§Ø¡Ø©
        document.getElementById('statusAnalysis').innerHTML = isSafe ? 
            `<div class="status-box ok">âœ… ØªÙ‚ÙŠÙŠÙ… Ø§Ù„ÙƒÙØ§Ø¡Ø©: Ø§Ù„Ù†Ø¸Ø§Ù… ÙƒØ§ÙÙ ØªÙ…Ø§Ù…Ø§Ù‹. ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ù…ØµÙÙˆÙØ§Øª ÙŠØ¶Ù…Ù† Ø¶ØºØ·Ø§Ù‹ ØµÙˆØªÙŠØ§Ù‹ (SPL) Ù…ØªØ¬Ø§Ù†Ø³Ø§Ù‹ Ø¹Ø¨Ø± Ø¹Ù…Ù‚ Ø§Ù„Ù‚Ø§Ø¹Ø© (${L}Ù…).</div>` :
            `<div class="status-box low">âš ï¸ ØªØ­Ø°ÙŠØ± Ù‡Ù†Ø¯Ø³ÙŠ: Ø§Ù„Ø¹Ø¯Ø¯ Ø§Ù„Ø­Ø§Ù„ÙŠ ØºÙŠØ± Ù…Ù†Ø·Ù‚ÙŠ Ù„Ø£Ø¨Ø¹Ø§Ø¯ Ø§Ù„Ù‚Ø§Ø¹Ø©! Ø§Ù„Ù…Ø³Ø§ÙØ© Ø§Ù„ÙƒØ¨ÙŠØ±Ø© ØªØªØ·Ù„Ø¨ Ù…ØµÙÙˆÙØ© Ø³Ù…Ø§Ø¹Ø§Øª Ø£ÙƒØ¨Ø± Ù„Ø¶Ù…Ø§Ù† ÙˆØµÙˆÙ„ Ø§Ù„ØªØ±Ø¯Ø¯Ø§Øª Ø§Ù„Ø¹Ø§Ù„ÙŠØ© Ù„Ù„Ø®Ù„Ù.</div>`;

        document.getElementById('roomSummary').innerHTML = `<b>Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù‡ÙŠÙƒÙ„ÙŠØ©:</b> Ø§Ù„Ø·ÙˆÙ„ ${L}Ù… | Ø§Ù„Ø¹Ø±Ø¶ ${document.getElementById('room_w').value}Ù… | Ø§Ù„Ø§Ø±ØªÙØ§Ø¹ ${H}Ù… | Ø§Ù„Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ© ${L*document.getElementById('room_w').value}Ù…Â²`;
        
        document.getElementById('boqTable').innerHTML = `
            <tr><th>Ø§Ù„Ù†Ø¸Ø§Ù…</th><th>Ø§Ù„Ù…ÙˆØ¯ÙŠÙ„ Ø§Ù„Ù…Ø¹ØªÙ…Ø¯</th><th>Ø§Ù„ÙƒÙ…ÙŠØ©</th></tr>
            <tr><td>Ø§Ù„Ù…Ù†Ø¸ÙˆÙ…Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</td><td>${document.getElementById('main_pa').value}</td><td>${mq} ÙˆØ­Ø¯Ø§Øª</td></tr>
            <tr><td>ÙˆØ­Ø¯Ø§Øª Ø§Ù„ØµØ¨ÙˆÙØ±</td><td>${document.getElementById('sub_pa').value}</td><td>${document.getElementById('sub_qty').value} ÙˆØ­Ø¯Ø§Øª</td></tr>
            <tr><td>Ø³Ù…Ø§Ø¹Ø§Øª Ø§Ù„Ø¬ÙˆØ§Ù†Ø¨</td><td>${document.getElementById('side_pa').value}</td><td>${document.getElementById('side_qty').value} ÙˆØ­Ø¯Ø§Øª</td></tr>
        `;

        if(manualPoints.length > 0) {
            document.getElementById('manualSection').style.display = 'block';
            let h = '<tr><th>Ø§Ù„Ø¬Ù‡Ø§Ø² Ø§Ù„Ù…Ø¶Ø§Ù</th><th>Ø§Ù„Ø¹Ø¯Ø¯</th><th>Ø§Ù„Ù…ÙˆÙ‚Ø¹</th></tr>';
            const counts = {};
            manualPoints.forEach(p => counts[p.name] = (counts[p.name] || 0) + 1);
            for(let n in counts) h += `<tr><td>${n}</td><td>${counts[n]}</td><td>Ø­Ø³Ø¨ Ø§Ù„ØªØ­Ø¯ÙŠØ¯ ÙÙŠ Ø§Ù„Ù…Ø®Ø·Ø·</td></tr>`;
            document.getElementById('manualTable').innerHTML = h;
        }

        document.getElementById('reportImg').src = canvas.toDataURL();
        document.getElementById('reportPage').style.display = 'block';
    }
    window.onload = draw;
</script>
</body>
</html>