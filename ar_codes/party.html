<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>Motivity Master AI - Ø§Ù„Ù…Ø³Ø§Ø­Ø§Øª Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠØ© 2026</title>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">
<style>
:root{--motivity-red:#e60012;--tech-blue:#38bdf8;--monitor-green:#22c55e;--bg:#0d1117;}
*{box-sizing:border-box;font-family:'Cairo',sans-serif;margin:0;padding:0}
body{background:var(--bg);color:#fff;display:flex;height:100vh;overflow:hidden}
.sidebar{width:420px;background:#161b22;padding:20px;overflow-y:auto;border-left:3px solid var(--motivity-red);flex-shrink:0}
.box{background:#21262d;padding:15px;border-radius:10px;margin-bottom:12px;border:1px solid #30363d}
h3{font-size:13px;color:var(--tech-blue);margin-bottom:8px;border-bottom:1px solid #444;padding-bottom:5px;text-transform:uppercase}
label{font-size:11px;color:#8b949e;display:block;margin-top:8px}
input,select{width:100%;padding:8px;background:#0d1117;color:#fff;border:1px solid #30363d;border-radius:6px;margin-top:4px;font-size:12px}
.btn-smart{background:linear-gradient(135deg,var(--motivity-red),#99000d);color:#fff;font-weight:900;padding:15px;border:none;border-radius:8px;cursor:pointer;width:100%;margin-bottom:10px;transition:0.3s}
.btn-reset{background:#30363d;color:#f85149;border:1px solid #f85149;padding:10px;border-radius:8px;cursor:pointer;width:100%;font-weight:bold;margin-bottom:10px}
.tool-btn{background:#0d1117;color:#fff;border:1px solid #444;padding:8px;font-size:11px;cursor:pointer;border-radius:6px;width:48%;margin-top:5px}
.tool-btn.active{background:var(--tech-blue);color:#000;font-weight:bold}
.main-view{flex:1;display:flex;flex-direction:column;align-items:center;justify-content:center;background:#000;position:relative}
canvas{background:#050505;border:1px solid #333;border-radius:12px;width:95%;cursor:crosshair}
.beam-controls{position:absolute;bottom:20px;background:rgba(22,27,34,0.95);padding:15px;border-radius:15px;border:1px solid var(--tech-blue);width:85%;display:flex;gap:20px;align-items:center}
#reportPage{display:none;position:fixed;inset:0;background:#fff;z-index:9999;color:#333;overflow-y:auto;padding:40px}
.report-content{max-width:1100px;margin:auto;border:2px solid #ddd;padding:30px;border-top:20px solid var(--motivity-red)}
.analysis-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:15px;margin:20px 0}
.analysis-card{background:#f8f9fa;padding:15px;border-radius:8px;border:1px solid #eee;text-align:center}
.analysis-card h4{color:var(--motivity-red);font-size:14px;margin-bottom:5px}
table{width:100%;border-collapse:collapse;margin:20px 0}
th,td{border:1px solid #ddd;padding:12px;text-align:right}
th{background:#f4f4f4;color:#333;font-weight:900}
@media print{.no-print{display:none!important}}
</style>
</head>
<body>

<div class="sidebar no-print">
<h2 style="color:var(--motivity-red);text-align:center;font-weight:900">MOTIVITY MASTER AI</h2>

<div class="box">
<h3>ğŸ“ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù‚Ø§Ø¹Ø© ÙˆØ§Ù„Ù…Ø³Ø±Ø­</h3>
<div style="display:flex;gap:5px">
<div><label>Ø§Ù„Ø·ÙˆÙ„ (L)</label><input type="number" id="room_l" value="120" oninput="draw()"></div>
<div><label>Ø§Ù„Ø¹Ø±Ø¶ (W)</label><input type="number" id="room_w" value="70" oninput="draw()"></div>
<div><label>Ø§Ù„Ø§Ø±ØªÙØ§Ø¹ (H)</label><input type="number" id="room_h" value="15" oninput="draw()"></div>
</div>
<div style="display:flex;gap:5px">
<div><label>Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø³Ø±Ø­</label><input type="number" id="stage_w" value="25" oninput="draw()"></div>
<div><label>Ø¹Ù…Ù‚ Ø§Ù„Ù…Ø³Ø±Ø­</label><input type="number" id="stage_d" value="12" oninput="draw()"></div>
</div>
</div>

<div class="box">
<h3>ğŸ¯ Ù†ÙˆØ¹ Ø§Ù„ÙØ¹Ø§Ù„ÙŠØ©</h3>
<select id="event_type">
<option value="auto">ÙƒØ´Ù ØªÙ„Ù‚Ø§Ø¦ÙŠ</option>
<option value="wedding">Ø­ÙÙ„ Ø²ÙØ§Ù</option>
<option value="concert">Ø­ÙÙ„ Ø¬Ù…Ø§Ù‡ÙŠØ±ÙŠ</option>
</select>
</div>

<button class="btn-reset" onclick="resetCanvas()">ğŸ”„ ØªØµÙÙŠØ± Ø§Ù„Ù…Ø®Ø·Ø·</button>

<div class="box">
<h3>ğŸ”Š Ø§Ù„ÙƒØªØ§Ù„ÙˆØ¬ Ø§Ù„ÙƒØ§Ù…Ù„ 2026</h3>
<label>1. Ø§Ù„Ø£Ù†Ø¸Ù…Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© ÙˆØ§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ©</label>
<select id="sel_main">
<optgroup label="Point Source">
<option value="DB-25 NW" data-spl="133" data-h="100" data-v="70">DB-25 NW (1000W / 133dB)</option>
<option value="DB-25 3G" data-spl="130" data-h="100" data-v="60">DB-25 3G (1000W / 130dB)</option>
<option value="MTL-700 3G" data-spl="126" data-h="90" data-v="60">MTL-700 3G (500W)</option>
</optgroup>
<optgroup label="Line Array Series">
<option value="MLA212" data-spl="138" data-h="90" data-v="10">MLA212 (Dual 12" - 900W)</option>
<option value="MLA210" data-spl="135" data-h="90" data-v="10">MLA210 (Dual 10" - 700W)</option>
<option value="M10-LA" data-spl="132" data-h="100" data-v="10">M10-LA (Compact 700W)</option>
<option value="MLA208" data-spl="130" data-h="100" data-v="10">MLA208 (Dual 8")</option>
</optgroup>
<optgroup label="Active Series">
<option value="HD315A" data-spl="131" data-h="90" data-v="60">HD315A (1000W Active)</option>
<option value="HD312A" data-spl="128" data-h="90" data-v="60">HD312A (1000W Active)</option>
</optgroup>
</select>

<label>2. Ø§Ù„ØªØ±Ø¯Ø¯Ø§Øª ÙˆØ§Ù„Ù…Ù„Ø­Ù‚Ø§Øª</label>
<select id="sel_extra">
<option value="DB-218 3G">DB-218 3G (Dual 18" - 1400W)</option>
<option value="QX-218">QX-218 (Dual 18" Touring)</option>
<option value="HD-SUB-18A">HD-SUB-18A (Active Sub)</option>
<option value="DB-15M 3G">DB-15M 3G (Stage Monitor)</option>
<option value="MTL-152">MTL-152 (KTV/Monitor)</option>
</select>

<div style="display:flex;justify-content:space-between;margin-top:10px">
<button class="tool-btn active" id="btn_main" onclick="setMode('main')">Ø¥Ø¶Ø§ÙØ© Ø±Ø¦ÙŠØ³ÙŠØ©</button>
<button class="tool-btn" id="btn_sub" onclick="setMode('sub')">Ø¥Ø¶Ø§ÙØ© ØµØ¨/Ù…ÙˆÙ†ÙŠØªÙˆØ±</button>
<button class="tool-btn" id="btn_side" onclick="setMode('side')">Ø¥Ø¶Ø§ÙØ© Ø¬Ø§Ù†Ø¨ÙŠØ©</button>
</div>
</div>

<button class="btn-smart" onclick="applySmartLayout()">ğŸš€ ØªÙˆØ²ÙŠØ¹ Ø°ÙƒÙŠ ØªÙ„Ù‚Ø§Ø¦ÙŠ</button>
<button class="btn-smart" style="background:var(--tech-blue);color:#000" onclick="generateReport()">ğŸ“„ ØªÙˆÙ„ÙŠØ¯ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù‡Ù†Ø¯Ø³ÙŠ</button>
</div>

<div class="main-view no-print">
<canvas id="mainCanvas"></canvas>
<div class="beam-controls">
<div style="flex:1">
<label style="color:var(--tech-blue);margin:0">ØªÙˆØ¬ÙŠÙ‡ Ø§Ù„ØªØºØ·ÙŠØ©</label>
<input type="range" id="beam_angle" min="0" max="360" value="90" oninput="updateSelected()">
</div>
<div style="flex:1">
<label style="color:var(--tech-blue);margin:0">Ø§Ù„Ù…Ø¯Ù‰ Ø§Ù„ÙØ¹Ù„ÙŠ</label>
<input type="range" id="beam_range" min="50" max="850" value="400" oninput="updateSelected()">
</div>
<div id="sel_name" style="font-weight:bold;font-size:12px;width:130px;color:var(--motivity-red)">-- Ø§Ø®ØªØ± Ù…Ù†ØªØ¬Ø§Ù‹ --</div>
</div>
</div>

<div id="reportPage">
<div class="report-content">
<button onclick="document.getElementById('reportPage').style.display='none'" class="no-print" style="padding:5px 15px;cursor:pointer">âŒ Ø¥ØºÙ„Ø§Ù‚</button>
<h1 style="color:var(--motivity-red);text-align:center;font-weight:900">ØªÙ‚Ø±ÙŠØ± Ø§Ù„ØªØ­Ù„ÙŠÙ„ Ø§Ù„ØµÙˆØªÙŠ Ø§Ù„Ù‡Ù†Ø¯Ø³ÙŠ 2026</h1>
<div class="analysis-grid">
<div class="analysis-card">
<h4>ğŸ”Š Ø¶ØºØ· Ø§Ù„ØµÙˆØª (SPL Max)</h4>
<p id="rep_spl_val">-- dB</p>
<small>Ø¹Ù†Ø¯ Ø¢Ø®Ø± Ù†Ù‚Ø·Ø© ØªØºØ·ÙŠØ©</small>
</div>
<div class="analysis-card">
<h4>â³ Ø²Ù…Ù† Ø§Ù„ØªØ£Ø®ÙŠØ± (Delay)</h4>
<p id="rep_delay_val">-- ms</p>
<small>Ù„Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„Ù…Ù†Ø§Ø·Ù‚ Ø§Ù„Ø®Ù„ÙÙŠØ©</small>
</div>
<div class="analysis-card">
<h4>ğŸ“ Ø²Ø§ÙˆÙŠØ© Ø§Ù„Ø§Ù†ØªØ´Ø§Ø± (H/V)</h4>
<p id="rep_angle_val">-- / --</p>
<small>Ø£ÙÙ‚ÙŠ / Ø¹Ù…ÙˆØ¯ÙŠ</small>
</div>
</div>
<div id="boqSection"></div>
<h3 style="border-bottom:2px solid #eee;margin-top:20px;">ğŸ—ºï¸ Ø®Ø±ÙŠØ·Ø© Ø§Ù„Ù…Ø­Ø§ÙƒØ§Ø© Ø§Ù„ØµÙˆØªÙŠØ©</h3>
<img id="reportImg" style="width:100%;background:#050505;border-radius:15px;margin-top:15px">
</div>
</div>

<script>
const canvas=document.getElementById('mainCanvas');
const ctx=canvas.getContext('2d');
let points=[];
let currentMode='main';
let selectedPoint=null;

const CATALOG={
"MLA212":{spl:138,hAngle:90,vAngle:10},
"MLA210":{spl:135,hAngle:90,vAngle:10},
"M10-LA":{spl:132,hAngle:100,vAngle:10},
"MLA208":{spl:130,hAngle:100,vAngle:10},
"HD315A":{spl:131,hAngle:90,vAngle:60},
"HD312A":{spl:128,hAngle:90,vAngle:60},
"DB-25 NW":{spl:133,hAngle:100,vAngle:70},
"DB-25 3G":{spl:130,hAngle:100,vAngle:60},
"MTL-700 3G":{spl:126,hAngle:90,vAngle:60},
"DB-218 3G":{spl:140,hAngle:45,vAngle:45},
"QX-218":{spl:140,hAngle:45,vAngle:45},
"HD-SUB-18A":{spl:140,hAngle:45,vAngle:45},
"DB-15M 3G":{spl:120,hAngle:90,vAngle:25},
"MTL-152":{spl:120,hAngle:90,vAngle:25}
};

function setMode(m){currentMode=m;document.querySelectorAll('.tool-btn').forEach(b=>b.classList.remove('active'));document.getElementById('btn_'+m).classList.add('active');}

function resetCanvas(){points=[];selectedPoint=null;document.getElementById('sel_name').innerText="-- Ø§Ø®ØªØ± Ù…Ù†ØªØ¬Ø§Ù‹ --";draw();}

function updateSelected(){if(selectedPoint){selectedPoint.angle=parseInt(document.getElementById('beam_angle').value);selectedPoint.range=parseInt(document.getElementById('beam_range').value);draw();}}

function getEventProfile(){
const type=document.getElementById('event_type').value;
const L=+room_l.value;let load="light";if(L>40)load="heavy";else if(L>25)load="medium";if(type==="auto"){if(L>40)return{type:"concert",load};return{type:"wedding",load};}return{type,load};
}

// ======= ØªÙˆØ²ÙŠØ¹ Ø°ÙƒÙŠ ÙƒØ§Ù…Ù„ =======
function applySmartLayout(){
points=[];
const profile=getEventProfile();
if(profile.type==="concert"){deployLineArraySystem(profile);}
else{deployPointSourceSystem(profile);}
draw();
}

function deployLineArraySystem(profile){
const L=+room_l.value,W=+room_w.value,sW=+stage_w.value,sD=+stage_d.value;
const scale=Math.min(1100/L,600/W)*0.8;
const oX=(1100-L*scale)/2,oY=(600-W*scale)/2,stX=oX+(L*scale-sW*scale)/2;
const elementsPerSide=Math.max(4,Math.ceil(L/10)),finalElements=elementsPerSide%2===0?elementsPerSide:elementsPerSide+1,toeIn=10;

points.push({x:stX-30,y:oY+(sD*scale/2),type:'main',name:'Ù„Ø§ÙŠÙ† Ø£Ø±Ø§ÙŠ ÙŠØ³Ø§Ø±',angle:90+toeIn,range:L*scale*0.9,spl:138,hAngle:90,vAngle:10,isLineArray:true,elements:finalElements/2});
points.push({x:stX+(sW*scale)+30,y:oY+(sD*scale/2),type:'main',name:'Ù„Ø§ÙŠÙ† Ø£Ø±Ø§ÙŠ ÙŠÙ…ÙŠÙ†',angle:90-toeIn,range:L*scale*0.9,spl:138,hAngle:90,vAngle:10,isLineArray:true,elements:finalElements/2});

// Subwoofers
const subCount=profile.load==="heavy"?6:4;
for(let i=0;i<subCount;i++){points.push({x:stX+(sW*scale/(subCount-1))*i,y:oY+(sD*scale)+25,type:'sub',name:'Ù…Ø¶Ø®Ù… ØµÙˆØª (Subwoofer)',angle:90,range:200});}

// Side Fills - ØªÙˆØ²ÙŠØ¹ Ù…ØªÙ‚Ø§Ø¨Ù„ (ÙŠÙ…ÙŠÙ† ÙˆÙŠØ³Ø§Ø±)
const sideCountPerSide = profile.load === "heavy" ? 3 : 2; // Ø¹Ø¯Ø¯ Ø§Ù„Ø³Ù…Ø§Ø¹Ø§Øª Ù„ÙƒÙ„ Ø¬Ø§Ù†Ø¨
for (let i = 0; i < sideCountPerSide; i++) {
    const yPos = oY + (W * scale / (sideCountPerSide + 1)) * (i + 1);

    // Ø³Ù…Ø§Ø¹Ø§Øª Ø§Ù„Ø¬Ø¯Ø§Ø± Ø§Ù„Ø£ÙŠØ³Ø± (ØªÙˆØ¬ÙŠÙ‡ Ù„Ù„ÙŠÙ…ÙŠÙ† Ø¨Ø²Ø§ÙˆÙŠØ© 0)
    points.push({
        x: oX + 15,
        y: yPos,
        type: 'side',
        name: 'Ø³Ù…Ø§Ø¹Ø© Ø¬Ø§Ù†Ø¨ÙŠØ© (ÙŠØ³Ø§Ø±)',
        angle: 0,
        range: (W * scale) * 0.4, // ØªØºØ·ÙŠØ© Ø­ØªÙ‰ Ù…Ù†ØªØµÙ Ø§Ù„Ø¹Ø±Ø¶ ØªÙ‚Ø±ÙŠØ¨Ø§Ù‹
        hAngle: 90
    });

    // Ø³Ù…Ø§Ø¹Ø§Øª Ø§Ù„Ø¬Ø¯Ø§Ø± Ø§Ù„Ø£ÙŠÙ…Ù† (ØªÙˆØ¬ÙŠÙ‡ Ù„Ù„ÙŠØ³Ø§Ø± Ø¨Ø²Ø§ÙˆÙŠØ© 180)
    points.push({
        x: oX + (L * scale) - 15,
        y: yPos,
        type: 'side',
        name: 'Ø³Ù…Ø§Ø¹Ø© Ø¬Ø§Ù†Ø¨ÙŠØ© (ÙŠÙ…ÙŠÙ†)',
        angle: 180,
        range: (W * scale) * 0.4,
        hAngle: 90
    });
}

// Stage Monitors
let monCount=sW>16?8:(sW>10?6:4);
for(let i=0;i<monCount;i++){points.push({x:stX+(sW*scale/(monCount-1))*i,y:oY+(sD*scale)-10,type:'sub',name:'Ù…ÙˆÙ†ÙŠØªÙˆØ± Ù…Ø³Ø±Ø­',angle:270,range:120});}
}

function deployPointSourceSystem(profile){
const L=+room_l.value,W=+room_w.value;
const scale=Math.min(1100/L,600/W)*0.8;
const oX=(1100-L*scale)/2,oY=(600-W*scale)/2;
const zones=Math.ceil(L/20);
for(let i=0;i<zones;i++){points.push({x:oX+(L*scale/(zones+1))*(i+1),y:oY+30,type:'main',name:'Ø³Ù…Ø§Ø¹Ø© Ù†Ù‚Ø·ÙŠØ© (Point Source)',angle:90,range:L*scale/zones,spl:130,hAngle:100,vAngle:60});}
}

// ======= Ø±Ø³Ù… ÙƒÙ„ Ø§Ù„Ø³Ù…Ø§Ø¹Ø§Øª =======
function draw(){
const L=+room_l.value,W=+room_w.value;
const sW=+stage_w.value,sD=+stage_d.value;
canvas.width=1100;canvas.height=600;
const scale=Math.min(canvas.width/L,canvas.height/W)*0.8;
const oX=(canvas.width-L*scale)/2,oY=(canvas.height-W*scale)/2;
ctx.clearRect(0,0,canvas.width,canvas.height);
ctx.fillStyle="#0d1117";ctx.fillRect(oX,oY,L*scale,W*scale);
ctx.strokeStyle="#333";ctx.lineWidth=4;ctx.strokeRect(oX,oY,L*scale,W*scale);

const stX=oX+(L*scale-sW*scale)/2;
ctx.fillStyle="rgba(230,0,18,0.1)";ctx.fillRect(stX,oY,sW*scale,sD*scale);
ctx.strokeStyle="#e60012";ctx.strokeRect(stX,oY,sW*scale,sD*scale);

points.forEach(p=>{
const angleRad=p.angle*(Math.PI/180);
const spread=(p.hAngle||100)*(Math.PI/180);
const grad=ctx.createRadialGradient(p.x,p.y,5,p.x,p.y,p.range);
if(p.type==='main'){grad.addColorStop(0,'rgba(56,189,248,0.6)');grad.addColorStop(1,'rgba(56,189,248,0.05)');}
else if(p.type==='side'){grad.addColorStop(0,'rgba(34,197,94,0.6)');grad.addColorStop(1,'rgba(34,197,94,0.05)');}
else{grad.addColorStop(0,'rgba(230,0,18,0.3)');grad.addColorStop(1,'transparent');}
ctx.fillStyle=grad;ctx.beginPath();ctx.moveTo(p.x,p.y);ctx.arc(p.x,p.y,p.range,angleRad-spread/2,angleRad+spread/2);ctx.closePath();ctx.fill();
if(p.isLineArray) drawLineArrayStack(p); else drawRegularSpeaker(p);
});
}

function drawRegularSpeaker(p){
ctx.beginPath();ctx.arc(p.x,p.y,8,0,Math.PI*2);
ctx.fillStyle=(p===selectedPoint)?"#fff":(p.type==='main'?'#38bdf8':p.type==='side'?'#22c55e':'#e60012');
ctx.fill();ctx.strokeStyle="#fff";ctx.stroke();
ctx.fillStyle="#fff";ctx.font="bold 10px Cairo";ctx.fillText(p.name,p.x+12,p.y+3);
}

function drawLineArrayStack(p){
const unitWidth=10,unitHeight=6,spacing=2;
const angleRad=p.angle*Math.PI/180;
ctx.save();ctx.translate(p.x,p.y);ctx.rotate(angleRad-Math.PI/2);
for(let i=0;i<p.elements;i++){ctx.fillStyle="rgba(56,189,248,0.9)";ctx.fillRect(-unitWidth/2,-(i*(unitHeight+spacing)),unitWidth,unitHeight);ctx.strokeStyle="#fff";ctx.strokeRect(-unitWidth/2,-(i*(unitHeight+spacing)),unitWidth,unitHeight);}
ctx.restore();ctx.fillStyle="#38bdf8";ctx.font="bold 11px Cairo";ctx.fillText(`Ù„Ø§ÙŠÙ† Ø£Ø±Ø§ÙŠ (${p.elements} ÙˆØ­Ø¯Ø§Øª)`,p.x+14,p.y-(p.elements*4));
}

// ======= Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø³Ù…Ø§Ø¹Ø§Øª ÙŠØ¯ÙˆÙŠÙ‹Ø§ Ù…Ø¹ Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„ÙƒØ§Ù…Ù„ =======
canvas.addEventListener('mousedown',e=>{
const rect=canvas.getBoundingClientRect();
const x=(e.clientX-rect.left)*(canvas.width/rect.width);
const y=(e.clientY-rect.top)*(canvas.height/rect.height);
const clicked=points.find(p=>Math.hypot(p.x-x,p.y-y)<15);
if(clicked){selectedPoint=clicked;document.getElementById('sel_name').innerText=selectedPoint.name;}
else{
const sel=document.getElementById(currentMode==='main'?'sel_main':'sel_extra');
const opt=sel.options[sel.selectedIndex];
const cat=CATALOG[opt.value]||{spl:120,hAngle:90,vAngle:60};
points.push({x,y,type:currentMode,name:opt.value,angle:90,range:400,spl:cat.spl,hAngle:cat.hAngle,vAngle:cat.vAngle});
selectedPoint=points[points.length-1];
}
draw();
});

// ======= Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù‡Ù†Ø¯Ø³ÙŠ Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠ =======
function buildEngineeringDecision(){
const profile=getEventProfile();
const L=+room_l.value,W=+room_w.value,sW=+stage_w.value;
const mainCount=points.filter(p=>p.type==='main').length;
const sideCount=points.filter(p=>p.type==='side').length;
const subCount=points.filter(p=>p.type==='sub'&&p.name.includes("Sub")).length;
const monitorCount=points.filter(p=>p.name.includes("Monitor")||p.name.includes("Ù…ÙˆÙ†ÙŠØªÙˆØ±")).length;
return{
eventText:`ØªÙ… ØªØµÙ…ÙŠÙ… Ø§Ù„Ù†Ø¸Ø§Ù… Ù„ÙØ¹Ø§Ù„ÙŠØ© (${profile.type==="concert"?"Ø­ÙÙ„ Ø¬Ù…Ø§Ù‡ÙŠØ±ÙŠ":"Ø­ÙÙ„ Ø²ÙØ§Ù"}) ÙÙŠ Ù‚Ø§Ø¹Ø© Ø¨Ù…Ø³Ø§Ø­Ø© ${L}Ù… Ã— ${W}Ù….`,
systemText:`Ø§Ù„Ù†Ø¸Ø§Ù… ÙŠØ´Ù…Ù„ ${mainCount} Ø³Ù…Ø§Ø¹Ø© Ø±Ø¦ÙŠØ³ÙŠØ©ØŒ Ùˆ${sideCount} Ø³Ù…Ø§Ø¹Ø§Øª Ø¬Ø§Ù†Ø¨ÙŠØ© Ù„ØªØºØ·ÙŠØ© Ø§Ù„Ø¬Ù…Ù‡ÙˆØ± Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ.`,
subText:`ØªÙ… ØªÙˆØ²ÙŠØ¹ ${subCount} Ù…Ø¶Ø®Ù… ØµÙˆØª (Subwoofer) Ù„ØªØºØ·ÙŠØ© Ø§Ù„ØªØ±Ø¯Ø¯Ø§Øª Ø§Ù„Ù…Ù†Ø®ÙØ¶Ø©.`,
monitorText:`${monitorCount} Ø³Ù…Ø§Ø¹Ø§Øª Ù…ÙˆÙ†ÙŠØªÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø³Ø±Ø­.`,
alternativeText:`ÙŠÙ…ÙƒÙ† ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„ØªÙˆØ²ÙŠØ¹ ÙŠØ¯ÙˆÙŠÙ‹Ø§ Ø£Ùˆ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù†Ø¸Ø§Ù… Ø¨Ø¯ÙŠÙ„ Ù„ØªØ­Ø³ÙŠÙ† Ø§Ù„ØªØºØ·ÙŠØ© Ø£Ùˆ Ø¶ØºØ· Ø§Ù„ØµÙˆØª.`
};
}

function generateReport(){
const decision=buildEngineeringDecision();
const counts={};
points.forEach(p=>counts[p.name]=(counts[p.name]||0)+1);
document.getElementById('boqSection').innerHTML=`
<div style="background:#f0f7ff;padding:15px;border-radius:10px;margin-bottom:20px;border-right:5px solid var(--tech-blue)">
<h3>ğŸ“˜ ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù‚Ø±Ø§Ø± Ø§Ù„Ù‡Ù†Ø¯Ø³ÙŠ</h3>
<p>${decision.eventText}</p>
<p><b>Ø¨Ù†ÙŠØ© Ø§Ù„Ù†Ø¸Ø§Ù…:</b> ${decision.systemText}</p>
<p><b>ØªØµÙ…ÙŠÙ… Ø§Ù„ØªØ±Ø¯Ø¯Ø§Øª Ø§Ù„Ù…Ù†Ø®ÙØ¶Ø©:</b> ${decision.subText}</p>
<p><b>Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ù…Ø³Ø±Ø­:</b> ${decision.monitorText}</p>
<p><b>Ø§Ù„Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆ Ø§Ù„Ø¨Ø¯ÙŠÙ„:</b> ${decision.alternativeText}</p>
</div>
<h3>ğŸ“¦ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ÙƒÙ…ÙŠØ§Øª ÙˆØ§Ù„Ù…ÙˆØ§ØµÙØ§Øª (BOQ)</h3>
<table><tr><th>Ø§Ù„Ù…Ù†ØªØ¬</th><th>Ø§Ù„ÙƒÙ…ÙŠØ©</th></tr>`+
Object.entries(counts).map(([n,c])=>`<tr><td><b>${n}</b></td><td>${c} ÙˆØ­Ø¯Ø§Øª</td></tr>`).join('')+
`</table>`;
document.getElementById('reportImg').src=canvas.toDataURL();
document.getElementById('reportPage').style.display='block';
}

window.onload=draw;
</script>
</body>
</html>
