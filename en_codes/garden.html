<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
    <meta charset="UTF-8">
    <title>MOTIVITY - Professional Acoustic Design Suite</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        :root{ --motivity-red:#e60012; --tech-blue:#38bdf8; --bg:#0b0e14; }
        *{box-sizing:border-box; font-family:'Inter', sans-serif; margin:0; padding:0}
        
        body{ background:var(--bg); color:#fff; display:flex; min-height:100vh; overflow-y: auto; }
        
        .sidebar{ 
            width:400px; 
            background:#161b22; 
            padding:25px; 
            border-right:4px solid var(--motivity-red); 
            height: 100vh; 
            position: sticky; 
            top: 0; 
            overflow-y: auto; 
            flex-shrink: 0;
        }

        .box{ background:#21262d; padding:18px; border-radius:12px; margin-bottom:15px; border:1px solid #30363d; }
        h3{ font-size:13px; color:var(--tech-blue); border-bottom:1px solid #444; padding-bottom:8px; margin-bottom:12px; text-transform:uppercase; letter-spacing:1px;}
        label{ font-size:11px; color:#8b949e; display:block; margin-top:10px; }
        input, select{ width:100%; padding:12px; background:#0d1117; color:#fff; border:1px solid #444; border-radius:8px; margin-top:5px; }

        .main-view{ flex:1; padding: 20px; display:flex; flex-direction:column; align-items:center; background:#000; }
        canvas{ background:#050505; border:2px solid #333; border-radius:20px; max-width:100%; height: auto; box-shadow: 0 0 40px rgba(0,0,0,0.8); }

        .btn-smart{ background:var(--tech-blue); color:#000; width:100%; padding:15px; margin:10px 0; font-weight:900; border:none; border-radius:10px; cursor:pointer; transition: 0.3s;}
        .btn-report{ background:var(--motivity-red); color:#fff; width:100%; padding:18px; font-weight:900; border:none; border-radius:10px; cursor:pointer; transition: 0.3s;}
        .btn-reset{ background:#333; color:#ff4d4d; width:100%; padding:12px; margin-top:10px; font-weight:700; border:1px solid #444; border-radius:10px; cursor:pointer;}
        
        button:hover{ opacity: 0.8; transform: translateY(-2px); }

        /* Report Page Overlay */
        #reportPage{ 
            display:none; 
            position:absolute; 
            inset:0; 
            background:#fff; 
            z-index:9999; 
            color:#333; 
            overflow-y:auto; 
            padding:50px; 
        }
        .report-content{ max-width:1000px; margin:auto; padding-bottom: 100px; }
        .kpi-grid{ display:grid; grid-template-columns:repeat(auto-fit, minmax(150px, 1fr)); gap:20px; margin:30px 0; }
        .kpi-item{ background:#f8f9fa; padding:20px; border-radius:12px; text-align:center; border-bottom: 4px solid var(--motivity-red); }
        .kpi-item h4{ font-size: 12px; color: #666; margin-bottom: 5px;}
        .kpi-item span{ font-size: 22px; font-weight: 900;}

        table{ width:100%; border-collapse:collapse; margin:30px 0; }
        th, td{ padding:15px; border:1px solid #eee; text-align:left; }
        th{ background:#f4f4f4; }
        
        .report-controls { display: flex; gap: 10px; margin-bottom: 20px; }
        .btn-print { background: #2ecc71; color: white; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; }

        @media print{ 
            .no-print{ display:none!important; } 
            #reportPage{ position:static; display:block; padding: 0; }
            body { background: white; }
        }
    </style>
</head>
<body>

<div class="sidebar no-print" id="ui-sidebar">
    <div style="text-align:center; margin-bottom:30px;">
        <h1 style="color:var(--motivity-red); font-size:28px; font-weight:900;">MOTIVITY</h1>
        <p style="color:#666; font-size:10px; letter-spacing: 2px;">ACOUSTIC ENGINEERING</p>
    </div>
    
    <div class="box">
        <h3>üåç Site Environment</h3>
        <label>Terrain Type</label>
        <select id="env_type" onchange="draw()">
            <option value="grass">üçÄ Natural Grass (High Absorption)</option>
            <option value="sand">üèñÔ∏è Sandy Soil (Beige / Soft Diffuse)</option>
            <option value="stone">üß± Stone Path (High Reflection)</option>
        </select>
        <label>Total Path Length (Meters)</label>
        <input type="number" id="area_len" value="100" oninput="draw()">
    </div>

    <div class="box">
        <h3>üîä Hardware Configuration</h3>
        <label>Speaker Model</label>
        <select id="model_select" onchange="draw()">
            <option value="AG-601">AG-601 Mushroom (30W)</option>
            <option value="AG-801">AG-801 Rock Speaker (50W)</option>
        </select>
        <label>Unit Quantity</label>
        <input type="number" id="qty" value="12" oninput="draw()">
    </div>

    <button class="btn-smart" onclick="applySmartAI()">‚ú® Smart Engineering Proposal</button>
    <button class="btn-report" onclick="openReport()">üìÑ Generate Technical Report</button>
    <button class="btn-reset" onclick="resetAll()">üîÑ Reset Design</button>
</div>

<div class="main-view no-print">
    <canvas id="gardenCanvas" width="1000" height="600"></canvas>
    <p style="margin-top:20px; color:#444; font-size: 13px;">* Visualization represents acoustic wave propagation based on surface absorption coefficients.</p>
</div>

<div id="reportPage">
    <div class="report-content">
        <div class="report-controls no-print">
            <button onclick="closeReport()" style="padding:10px 20px; cursor:pointer;">üîô Edit Design</button>
            <button onclick="window.print()" class="btn-print">üíæ Save as PDF / Print</button>
        </div>
        
        <h1 style="color:var(--motivity-red); border-bottom:3px solid #eee; padding-bottom:10px">Advanced Acoustic Analysis Report</h1>
        
        <div id="techAnalysis" style="background:#f9f9f9; padding:25px; border-left:5px solid var(--tech-blue); margin:30px 0; line-height:1.8; font-size: 15px;"></div>

        <div class="kpi-grid" id="kpiBox"></div>

        <table>
            <thead>
                <tr style="background:#f4f4f4">
                    <th>Technical Parameter</th>
                    <th>Calculated Value</th>
                    <th>Status</th>
                </tr>
            </thead>
            <tbody id="dataTable"></tbody>
        </table>

        <h3>Acoustic Simulation (Top-View Mapping):</h3>
        <img id="resImg" style="width:100%; border-radius:15px; border:1px solid #ddd; margin-top:15px">
        
        <div style="margin-top:50px; text-align:center; font-size:11px; color:#999; border-top:1px solid #eee; padding-top:20px;">
            This document is an automated engineering output by Motivity AI - Compliant with IEC 60268-5 Standards.
        </div>
    </div>
</div>

<script>
    const canvas = document.getElementById("gardenCanvas");
    const ctx = canvas.getContext("2d");

    function resetAll() {
        if(confirm("Clear all current design data?")) {
            document.getElementById('area_len').value = 100;
            document.getElementById('qty').value = 12;
            document.getElementById('env_type').selectedIndex = 0;
            document.getElementById('model_select').selectedIndex = 0;
            draw();
        }
    }

    function draw() {
        const len = +document.getElementById('area_len').value;
        const q = +document.getElementById('qty').value || 1;
        const env = document.getElementById('env_type').value;
        const model = document.getElementById('model_select').value;
        
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        ctx.fillStyle = "#050505";
        ctx.fillRect(0, 0, canvas.width, canvas.height);

        let themeColor = env === 'grass' ? "rgba(46, 204, 113," : env === 'sand' ? "rgba(212, 163, 115," : "rgba(236, 240, 241,";
        let bgColor = env === 'grass' ? "#1b4332" : env === 'sand' ? "#d4a373" : "#34495e";

        ctx.fillStyle = bgColor;
        ctx.globalAlpha = 0.2;
        ctx.fillRect(50, 350, 900, 60);
        ctx.globalAlpha = 1.0;

        const spacing = 900 / q;
        for(let i=0; i<q; i++) {
            let x = 50 + (i * spacing) + (spacing/2);
            let y = 380;

            for(let r=1; r<=3; r++) {
                ctx.beginPath();
                ctx.strokeStyle = themeColor + (0.5 - r*0.15) + ")";
                ctx.lineWidth = 2;
                ctx.arc(x, y, r * 35 * (env === 'stone' ? 1.3 : 1), 0, Math.PI * 2);
                ctx.stroke();
            }

            ctx.fillStyle = "#000";
            if(model === "AG-601") {
                ctx.beginPath(); ctx.arc(x, y-12, 12, Math.PI, 0); ctx.fill(); 
                ctx.fillRect(x-6, y-12, 12, 18);
            } else {
                ctx.fillStyle = "#444";
                ctx.beginPath();
                ctx.moveTo(x-15, y+5); ctx.lineTo(x+15, y+5); ctx.lineTo(x+10, y-12); ctx.lineTo(x-12, y-12);
                ctx.closePath(); ctx.fill();
            }
        }
    }

    function applySmartAI() {
        const len = +document.getElementById('area_len').value;
        const env = document.getElementById('env_type').value;
        let interval = env === 'grass' ? 8 : env === 'sand' ? 10 : 14;
        document.getElementById('qty').value = Math.ceil(len / interval);
        draw();
    }

    function openReport() {
        const q = +document.getElementById('qty').value;
        const len = +document.getElementById('area_len').value;
        const env = document.getElementById('env_type').value;
        const model = document.getElementById('model_select').value;
        const watt = model === 'AG-601' ? 30 : 50;

        document.getElementById('techAnalysis').innerHTML = `
            <h3>üî¨ Engineering Rationale:</h3>
            <p>The proposed distribution for this <b>${len}m</b> path accounts for the specific terrain of <b>${env}</b>. 
            Using the <b>${model}</b> series ensures IP66-rated weather resistance and consistent 90-94 dB output.</p>
        `;

        document.getElementById('kpiBox').innerHTML = `
            <div class="kpi-item"><h4>Total Power</h4><span>${q*watt}W</span></div>
            <div class="kpi-item"><h4>Spacing</h4><span>${(len/q).toFixed(1)}m</span></div>
            <div class="kpi-item"><h4>Status</h4><span>Calibrated</span></div>
        `;

        document.getElementById('dataTable').innerHTML = `
            <tr><td>Total Load</td><td>${q*watt} Watts</td><td>‚úÖ Optimized</td></tr>
            <tr><td>Recommended Amp</td><td>Min. ${(q*watt*1.2).toFixed(0)}W</td><td>‚úÖ Safe</td></tr>
            <tr><td>Environment</td><td>${env.toUpperCase()}</td><td>‚úÖ Analyzed</td></tr>
        `;

        document.getElementById('resImg').src = canvas.toDataURL();
        document.getElementById('reportPage').style.display = "block";
        window.scrollTo(0,0);
    }

    function closeReport() { document.getElementById('reportPage').style.display = "none"; }
    window.onload = draw;
</script>
</body>
</html>
