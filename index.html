<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Motivity AI Master | المهندس إبراهيم عربي</title>
    <style>
        :root { --red: #e60012; --dark: #020617; --panel: #0f172a; --blue: #38bdf8; --green: #10b981; }
        body { margin: 0; display: flex; height: 100vh; background: var(--dark); color: #fff; font-family: 'Segoe UI', Tahoma, sans-serif; overflow: hidden; }
        
        @media (max-width: 768px) { body { flex-direction: column; overflow-y: auto; } .sidebar { width: 100% !important; border-left: none !important; border-bottom: 3px solid var(--red); } canvas { height: 350px !important; } }

        .sidebar { width: 420px; background: var(--panel); padding: 20px; border-left: 3px solid var(--red); overflow-y: auto; display: flex; flex-direction: column; }
        .logo-container { text-align: center; margin-bottom: 20px; background: #000; padding: 15px; border-radius: 10px; border: 1px solid #1e293b; }
        .logo-text { font-size: 38px; font-weight: 900; color: #fff; letter-spacing: -1px; margin: 0; }
        .logo-text span { color: var(--red); }

        .box { background: #1e293b; padding: 15px; border-radius: 8px; margin-bottom: 12px; border-right: 4px solid var(--red); }
        h3 { margin: 0 0 10px; font-size: 14px; color: var(--blue); border-bottom: 1px solid #334155; padding-bottom: 5px; }
        label { font-size: 12px; color: #94a3b8; display: block; margin-top: 8px; }
        select, input { width: 100%; padding: 10px; background: #020617; border: 1px solid #475569; color: #fff; border-radius: 5px; margin-top: 5px; font-size: 13px; outline: none; }
        
        .viewport { flex: 1; display: flex; flex-direction: column; background: #000; position: relative; }
        canvas { flex: 1; margin: 15px; background: #0f172a; border: 1px solid #334155; border-radius: 5px; }

        .dashboard { height: 90px; background: #000; border-top: 2px solid var(--red); display: grid; grid-template-columns: repeat(4, 1fr); align-items: center; text-align: center; }
        .stat-v { font-size: 22px; font-weight: bold; color: var(--red); display: block; }
        .stat-l { font-size: 10px; color: #94a3b8; text-transform: uppercase; }

        .btn { border: none; color: #fff; width: 100%; padding: 14px; border-radius: 6px; font-weight: bold; cursor: pointer; margin-top: 10px; font-size: 14px; transition: 0.2s; }
        .btn-add { background: var(--red); }
        .btn-report { background: var(--green); margin-top: 20px; }

        .item-row { background: #020617; padding: 10px; border-radius: 5px; margin-top: 8px; border: 1px solid #1e293b; font-size: 12px; display: flex; justify-content: space-between; }
        .del { color: #ef4444; cursor: pointer; font-weight: bold; }

        #reportOverlay { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:#fff; color:#000; z-index:9999; padding:30px; overflow-y:auto; }
    </style>
</head>
<body>

<div class="sidebar">
    <div class="logo-container">
        <div class="logo-text">Moti<span>V</span>ity</div>
        <div style="font-size: 10px; color: #94a3b8; letter-spacing: 3px; margin-top: 5px;">AI AUDIO MASTER 2026</div>
    </div>

    <div class="box">
        <h3>1. إعدادات الموقع</h3>
        <div style="display:flex; gap:10px;">
            <div style="flex:1;"><label>العرض (م)</label><input type="number" id="vW" value="40" oninput="render()"></div>
            <div style="flex:1;"><label>الطول (م)</label><input type="number" id="vL" value="60" oninput="render()"></div>
        </div>
    </div>

    <div class="box">
        <h3>2. مهندس النظام (إضافة الموديلات)</h3>
        <label>الموديل:</label>
        <select id="sel_model">
           <optgroup label="HD Series (Active)">
               <option value="HD Sub18">HD Sub18 Active (1200W)</option>
               <option value="HD315A">HD315A Active (1000W)</option>
               <option value="HD312A">HD312A Active (1000W)</option>
           </optgroup>
           <optgroup label="3G Series">
               <option value="DB25-3G">DB25-3G Full Range Passive (1000W)</option>
               <option value="MTL-700 3G">MTL-700 3G Passive (700W)</option>
               <option value="DB15M-3G">DB15M-3G Passive Stage Monitor (500W)</option>
               <option value="DB218-3G">DB218-3G Passive Subwoofer (1600W)</option>
           </optgroup>
           <optgroup label="QX Series">
               <option value="QX-218">QX-218 Passive Subwoofer (1400W)</option>
               <option value="QX-118">QX-118 Passive Subwoofer (700W)</option>
           </optgroup>
           <optgroup label="M Series-Line Array">
               <option value="M-25BW">M-25BW Passive Line Array Subwoofer (1000W)</option>
               <option value="M-10">M-10 Passive Line Array Top (700W)</option>
           </optgroup>
           <optgroup label="Traditional DB">
               <option value="DB-25NW">DB-25NW Passive (1000W)</option>
               <option value="MTL-152">MTL-152 Passive (600W)</option>
               <option value="DB-10">DB-10 Passive (200W)</option>
               <option value="DB-25OW">DB-25OW Passive (1000W)</option>
           </optgroup>
           <optgroup label="MLA Series-Line Array">
               <option value="MLA-25B">MLA-25B Passive Line Array Subwoofer (1000W)</option>
               <option value="MLA-210">MLA-210 Passive Line Array Top (700W)</option>
               <option value="MLA-212">MLA-212 Passive Line Array Top (900W)</option>
           </optgroup>
        </select>

        <label>الكمية</label>
        <input type="number" id="sel_qty" value="4" min="1">
        <button class="btn btn-add" onclick="addItem()">إضافة للنظام</button>
    </div>

    <div id="items_list"></div>

    <div style="margin-top:auto">
        <button class="btn btn-report" onclick="showReport()">إصدار تقرير العميل</button>
        <p style="font-size: 10px; color: #475569; text-align: center; margin-top: 15px;">المصمم: السيد إبراهيم علي عربي © 2026</p>
    </div>
</div>

<div class="viewport">
    <canvas id="cv"></canvas>
    <div class="dashboard">
        <div><span class="stat-v" id="d_watt">0 W</span><span class="stat-l">الطاقة الكلية</span></div>
        <div><span class="stat-v" id="d_qty">0</span><span class="stat-l">عدد الوحدات</span></div>
        <div><span class="stat-v" id="d_spl">0 dB</span><span class="stat-l">Peak SPL</span></div>
        <div><span class="stat-v" id="d_status" style="color:#444">---</span><span class="stat-l">التغطية</span></div>
    </div>
</div>

<div id="reportOverlay">
    <div id="reportContent"></div>
    <div style="display:flex; gap:10px; margin-top:20px;">
        <button class="btn" style="background:var(--green);" onclick="window.print()">طباعة التقرير</button>
        <button class="btn" style="background:#666;" onclick="document.getElementById('reportOverlay').style.display='none'">إغلاق</button>
    </div>
</div>

<script>
    const catalog = {
        "HD Sub18": 1200, "HD315A": 1000, "HD312A": 1000, "DB25-3G": 1000, 
        "MTL-700 3G": 700, "DB15M-3G": 500, "DB218-3G": 1600, "QX-218": 1400,
        "QX-118": 700, "M-25BW": 1000, "M-10": 700, "DB-25NW": 1000,
        "MTL-152": 600, "DB-10": 200, "DB-25OW": 1000, "MLA-25B": 1000,
        "MLA-210": 700, "MLA-212": 900
    };

    let items = [];

    function addItem() {
        items.push({ model: sel_model.value, qty: parseInt(sel_qty.value) });
        updateUI(); render();
    }

    function updateUI() {
        items_list.innerHTML = items.map((it, i) => `
            <div class="item-row">
                <span><strong>${it.model}</strong> (${it.qty} قطع)</span>
                <span class="del" onclick="items.splice(${i},1);updateUI();render()">✕</span>
            </div>`).join('');
    }

    function render() {
        const c = cv, x = c.getContext("2d");
        c.width = c.parentElement.clientWidth - 30; c.height = c.parentElement.clientHeight - 110;
        const W = +vW.value, L = +vL.value;
        const scale = Math.min(c.width / W, c.height / L) * 0.85;
        const ox = (c.width - W * scale) / 2, oy = (c.height - L * scale) / 2;

        x.clearRect(0, 0, c.width, c.height);
        x.fillStyle = "#0f172a"; x.fillRect(ox, oy, W * scale, L * scale);
        x.strokeStyle = "#e60012"; x.strokeRect(ox, oy, W * scale, L * scale);

        let tW = 0, tQ = 0;
        items.forEach((it, idx) => {
            tW += (catalog[it.model] * it.qty); tQ += it.qty;
            x.fillStyle = "#38bdf8";
            x.shadowBlur = 15; x.shadowColor = "#38bdf8";
            x.fillRect(ox + 20 + (idx*20), oy + 20 + (idx*10), 12, 12);
            x.shadowBlur = 0;
        });

        d_watt.innerText = tW.toLocaleString() + " W";
        d_qty.innerText = tQ;
        d_spl.innerText = tW > 0 ? (Math.floor(115 + 10 * Math.log10(tW/1000))) + " dB" : "0 dB";
        d_status.innerText = tQ > 4 ? "ممتازة" : "تحتاج تدعيم";
        d_status.style.color = tQ > 4 ? "#10b981" : "orange";
    }

    function showReport() {
        const content = document.getElementById('reportContent');
        content.innerHTML = `
            <div style="direction:rtl; font-family:sans-serif;">
                <h1 style="text-align:center; font-size:40px; margin:0; color:#000;">MOTI<span style="color:red;">V</span>ITY AUDIO</h1>
                <p style="text-align:center; border-bottom:2px solid red; padding-bottom:10px;">تقرير التصميم الهندسي للمشروع</p>
                <div style="background:#f4f4f4; padding:15px; margin:20px 0;">
                    <p><strong>اسم المشروع:</strong> محاكاة توزيع صوتي ذكي</p>
                    <p><strong>إعداد المهندس:</strong> إبراهيم علي عربي</p>
                    <p><strong>تاريخ التقرير:</strong> ${new Date().toLocaleDateString('ar-EG')}</p>
                    <p><strong>القدرة الكلية للنظام:</strong> ${d_watt.innerText}</p>
                </div>
                <table border="1" style="width:100%; border-collapse:collapse; text-align:center;">
                    <tr style="background:#000; color:#fff;"><th>الموديل المختار</th><th>الكمية</th><th>القدرة (RMS)</th><th>الإجمالي</th></tr>
                    ${items.map(it => `<tr><td>${it.model}</td><td>${it.qty}</td><td>${catalog[it.model]}W</td><td>${catalog[it.model]*it.qty}W</td></tr>`).join('')}
                </table>
                <p style="margin-top:30px; font-style:italic;">* تم استخدام معايير Motivity 2026 تحت إشراف هندسي متكامل.</p>
            </div>`;
        document.getElementById('reportOverlay').style.display = 'block';
    }
    render();
</script>
</body>
</html>
